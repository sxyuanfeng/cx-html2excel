import*as e from"exceljs";var t={824:t=>{t.exports=e}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,a),o.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};(()=>{a.d(n,{F:()=>f});const e=a(824);var t=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,r=/^(\d+)-(\d+)-(\d+)$/,o=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/,i=Date.UTC(1899,11,30,0,0,0),l=Date.UTC(1899,11,31,0,0,0),s=Date.UTC(1904,0,1,0,0,0),g=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,c=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,u=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,m=-177984e5==new Date("6/9/69 00:00 UTC").valueOf(),d=["january","february","march","april","may","june","july","august","september","october","november","december"],h={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'};const p={rows:!0,font:!0,alignment:!0,border:!0,numfmt:!0,chart:!0};function f(t,r){const a={...p,...r};let n=new e.Workbook;for(let e of t){let t=v(e.elet,a),r=n.addWorksheet(e.name);if(r.columns=t["!cols"],a.rows){let e=t["!rows"];for(let t=0;t<e.length;t++){let a=e[t];r.getRow(t+1).height=a.hpx}}let o=t["!merges"];for(let e of o)r.mergeCells(y(e));let i=t["!data"];for(let e in i){let t=r.getCell(e);if(t.value=i[e].v,a.font&&(t.font=i[e].s.font),a.alignment&&(t.alignment=i[e].s.alignment),a.border&&(t.border=i[e].s.border),a.numfmt&&(t.numFmt=i[e].z),a.chart&&i[e].chart){const t=n.addImage({base64:i[e].chart.base64,extension:"png"});r.addImage(t,{tl:{col:T(e).c,row:T(e).r},ext:{width:i[e].chart.width,height:i[e].chart.height}})}}}return n.xlsx.writeBuffer().then((e=>e))}function w(e,t,r){let a=A(e),n=e.getAttribute("rowspan")||1,o=e.getAttribute("colspan")||1,i=r+Number(n),l=y({s:{c:t,r},e:{c:t+Number(o),r:i}}),s=e.getElementsByTagName("img"),g=e.getElementsByTagName("canvas");if(s.length>0){let e=s[0],t=0,r=0;a&&(t=a(e).getPropertyValue("width").match(/\d+/g)[0]),a&&(r=a(e).getPropertyValue("height").match(/\d+/g)[0]);const n=document.createElement("canvas");return n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0),{width:t,height:r,range:l,base64:n.toDataURL("image/png")}}if(g.length>0){let e=g[0],t=0,r=0;return a&&(t=a(e).getPropertyValue("width").match(/\d+/g)[0]),a&&(r=a(e).getPropertyValue("height").match(/\d+/g)[0]),{width:t,height:r,range:l,base64:e.toDataURL("image/png")}}}function b(e){let t=A(e),r={};if(t){let a={};a.size=t(e).getPropertyValue("font-size").match(/\d+/g)[0];let n=t(e).getPropertyValue("font-family"),o={SimSun:"SimSun"};a.name=o[n]??"SimSun",a.bold="700"===t(e).getPropertyValue("font-weight");let i=N(t(e).getPropertyValue("color")).color;a.color={argb:"ff"+i},r.font=a;let l={};l.wrapText="nowrap"!==t(e).getPropertyValue("white-space"),l.horizontal=t(e).getPropertyValue("text-align"),l.vertical=t(e).getPropertyValue("vertical-align"),r.alignment=l;let s={top:D(t(e).getPropertyValue("border-top")),bottom:D(t(e).getPropertyValue("border-bottom")),left:D(t(e).getPropertyValue("border-left")),right:D(t(e).getPropertyValue("border-right"))};r.border=JSON.parse(JSON.stringify(s))}return r}function v(e,t){var r={};return(t||{}).dense&&(r["!data"]=[]),function(e,t,r){var a=t.rows;if(!a)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var n=r||{},o=(e["!data"],0),i=0;if(null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var l="string"==typeof n.origin?T(n.origin):n.origin;o=l.r,i=l.c}var s=Math.min(n.sheetRows||1e7,a.length),g={s:{r:0,c:0},e:{r:o,c:i}};if(e["!ref"]){var c=function(e){var t=e.indexOf(":");return-1==t?{s:T(e),e:T(e)}:{s:T(e.slice(0,t)),e:T(e.slice(t+1))}}(e["!ref"]);g.s.r=Math.min(g.s.r,c.s.r),g.s.c=Math.min(g.s.c,c.s.c),g.e.r=Math.max(g.e.r,c.e.r),g.e.c=Math.max(g.e.c,c.e.c),-1==o&&(g.e.r=o=c.e.r+1)}var u=[],m=0,d=e["!rows"]||(e["!rows"]=[]),p=0,f=0,v=0,D=0,N=0,F=0;e["!cols"]||(e["!cols"]=[]);let E=t.getElementsByTagName("colgroup")[0].getElementsByTagName("col");for(let t=0;t<E.length;t++){let r=E[t],a=A(r),n=0;a&&(n=a(r).getPropertyValue("width").match(/\d+/g)[0]),e["!cols"].push({key:String(t),width:(Number(n)/5).toFixed(6)})}for(;p<a.length&&f<s;++p){var I=a[p];if(x(I)){if(n.display)continue;d[f]={hidden:!0}}d[f]?d[f].hpx=I.clientHeight:d[f]={hpx:I.clientHeight};let t=[];for(let e of a)t.push({hpx:e.clientHeight});e["!rows"]=t;var $=I.cells;for(v=D=0;v<$.length;++v){var j=$[v];if(!n.display||!x(j)){var O=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):z(j.innerHTML),R=j.getAttribute("data-z")||j.getAttribute("z");for(m=0;m<u.length;++m){var B=u[m];B.s.c==D+i&&B.s.r<f+o&&f+o<=B.e.r&&(D=B.e.c+1-i,m=-1)}F=+j.getAttribute("colspan")||1,((N=+j.getAttribute("rowspan")||1)>1||F>1)&&u.push({s:{r:f+o,c:D+i},e:{r:f+o+(N||1)-1,c:D+i+(F||1)-1}});var L={t:"s",v:O},H=j.getAttribute("data-t")||j.getAttribute("t")||"";null!=O&&(0==O.length?L.t=H||"z":n.raw||0==O.trim().length||"s"==H||("TRUE"===O?L={t:"b",v:!0}:"FALSE"===O?L={t:"b",v:!1}:isNaN(S(O))?isNaN(M(O).getDate())||(L={t:"d",v:V(O)},n.UTC&&(L.v=P(L.v)),n.cellDates||(L={t:"n",v:U(L.v)}),L.z=n.dateNF||R||h[14]):L={t:"n",v:S(O)})),void 0===L.z&&null!=R&&(L.z=R);var k="",W=j.getElementsByTagName("A");if(W&&W.length)for(var Y=0;Y<W.length&&(!W[Y].hasAttribute("href")||"#"==(k=W[Y].getAttribute("href")).charAt(0));++Y);k&&"#"!=k.charAt(0)&&"javascript:"!=k.slice(0,11).toLowerCase()&&(L.l={Target:k}),L.s=b(j),w(j)&&(L.chart=w(j,D+i,f+o)),e["!data"]||(e["!data"]={}),e["!data"][C({c:D+i,r:f+o})]=L,g.e.c<D+i&&(g.e.c=D+i),D+=F}}++f}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),g.e.r=Math.max(g.e.r,f-1+o),e["!ref"]=y(g),f>=s&&(e["!fullref"]=y((g.e.r=a.length-p+f-1+o,g))),console.log(e),e}(r,e,t)}function y(e,t){return void 0===t||"number"==typeof t?y(e.s,e.e):("string"!=typeof e&&(e=C(e)),"string"!=typeof t&&(t=C(t)),e==t?e:e+":"+t)}function D(e){let t=e.replace(new RegExp(", ","g"),",").split(" "),r={solid:"thin"}[t[1]];if(r)return{style:r,color:{argb:"ff"+N(t[2]).color}}}function N(e){if(e.startsWith("rgba")){let t=e.slice(5,e.length-1).split(","),r=100*Number(t[3].trim()),a="";return a+=((1<<24)+(Number(t[0].trim())<<16)+(Number(t[1].trim())<<8)+Number(t[2].trim())).toString(16).slice(1),{color:a,opacity:r}}let t=e.slice(4,e.length-1).split(","),r="";return r+=((1<<24)+(Number(t[0].trim())<<16)+(Number(t[1].trim())<<8)+Number(t[2].trim())).toString(16).slice(1),{color:r}}function T(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function C(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function x(e){var t="",r=A(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function U(e,t){var r=(e.getTime()-i)/864e5;return t?(r-=1462)<-1402?r-1:r:r<60?r-1:r}function A(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}function P(e){return console.log(new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))),new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function V(e,a){if(e instanceof Date)return e;var n=e.match(t);return n?new Date((a?s:l)+1e3*(60*(60*parseInt(n[1],10)+parseInt(n[2],10))+(n[3]?parseInt(n[3].slice(1),10):0))+(n[4]?parseInt((n[4]+"000").slice(1,4),10):0)):(n=e.match(r))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],0,0,0,0)):(n=e.match(o))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt(n[7].slice(1),10)||0)):new Date(e)}function S(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(a))?(a=a.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(a))?t:t/r):t/r}function M(e){if(u.test(e))return-1==e.indexOf("Z")?P(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),a=r.match(g);if(a)return function(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,"p"==e[7]?12:0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),0,0,0))}(a);if(a=r.match(c))return function(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}(a);if(a=r.match(o))return new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],a[6]&&parseInt(a[6].slice(1),10)||0,a[7]&&parseInt(a[7].slice(1),10)||0));var n=new Date(m&&-1==e.indexOf("UTC")?e+" UTC":e),i=new Date(NaN),l=n.getYear(),s=(n.getMonth(),n.getDate());if(isNaN(s))return i;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==d.indexOf(t))return i}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return i;return l<0||l>8099||e.match(/[^-0-9:,\/\\\ ]/)?i:n}var F,z=(F=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]})),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<F.length;++r)t=t.replace(F[r][0],F[r][1]);return t})})();var o=n.F;export{o as generateExcel};
//# sourceMappingURL=cx-html2excel.min.mjs.map