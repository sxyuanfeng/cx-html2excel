import*as e from"exceljs";var t={824:t=>{t.exports=e}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,a),i.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};(()=>{a.d(n,{F:()=>b});const e=a(824);var t=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,r=/^(\d+)-(\d+)-(\d+)$/,i=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/,o=Date.UTC(1899,11,30,0,0,0),l=Date.UTC(1899,11,31,0,0,0),g=Date.UTC(1904,0,1,0,0,0),s=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,u=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,c=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,m=-177984e5==new Date("6/9/69 00:00 UTC").valueOf(),d=["january","february","march","april","may","june","july","august","september","october","november","december"],h={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'};const p=["SimSun","SimHei","Microsoft YaHei","Microsoft JhengHei","NSimSun","PMingLiU","MingLiU","DFKai-SB","FangSong","KaiTi","FangSong_GB2312","KaiTi_GB2312","STHeiti Light","STHeiti","STKaiti","STSong","STFangsong","LiHei Pro Medium","LiSong Pro Light","BiauKai","Apple LiGothic Medium","Apple LiSung Light","LiSu","YouYuan","STXihei","STZhongsong","FZShuTi","FZYaoti","STCaiyun","STHupo","STLiti","STXingkai","STXinwei"],f={rows:!0,font:!0,alignment:!0,border:!0,numfmt:!0,chart:!0};function b(t,r){const a={...f,...r};let n=new e.Workbook;for(let e of t){let t=v(e.elet,a),r=n.addWorksheet(e.name);if(r.columns=t["!cols"],a.rows){let e=t["!rows"];for(let t=0;t<e.length;t++){let a=e[t];r.getRow(t+1).height=a.hpx}}let i=t["!merges"];for(let e of i)r.mergeCells(D(e));let o=t["!data"];for(let e in o){let t=r.getCell(e);if(t.value=o[e].v,a.font&&(t.font=o[e].s.font),a.alignment&&(t.alignment=o[e].s.alignment),a.border&&(t.border=o[e].s.border),a.numfmt&&(t.numFmt=o[e].z),a.chart&&o[e].chart){const t=n.addImage({base64:o[e].chart.base64,extension:"png"});r.addImage(t,{tl:{col:N(e).c,row:N(e).r},ext:{width:o[e].chart.width,height:o[e].chart.height}})}}}return n.xlsx.writeBuffer().then((e=>e))}function w(e,t,r){let a=P(e),n=e.getAttribute("rowspan")||1,i=e.getAttribute("colspan")||1,o=r+Number(n),l=D({s:{c:t,r},e:{c:t+Number(i),r:o}}),g=e.getElementsByTagName("img"),s=e.getElementsByTagName("canvas");if(g.length>0){let e=g[0],t=0,r=0;a&&(t=a(e).getPropertyValue("width").match(/\d+/g)[0]),a&&(r=a(e).getPropertyValue("height").match(/\d+/g)[0]);const n=document.createElement("canvas");return n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0),{width:t,height:r,range:l,base64:n.toDataURL("image/png")}}if(s.length>0){let e=s[0],t=0,r=0;return a&&(t=a(e).getPropertyValue("width").match(/\d+/g)[0]),a&&(r=a(e).getPropertyValue("height").match(/\d+/g)[0]),{width:t,height:r,range:l,base64:e.toDataURL("image/png")}}}function y(e){let t=P(e),r={};if(t){let a={};a.size=t(e).getPropertyValue("font-size").match(/\d+/g)[0];let n=t(e).getPropertyValue("font-family");a.name=-1!==p.indexOf([n])?n:"SimSun",a.bold="700"===t(e).getPropertyValue("font-weight");let i={italic:"italic",oblique:"oblique"};a.italic=!!i[t(e).getPropertyValue("font-style")];let o=t(e).getPropertyValue("text-decoration");a.underline="underline"===o,a.strike="line-through"===o;let l=S(t(e).getPropertyValue("color")).color;a.color={argb:"ff"+l},r.font=a;let g={};g.wrapText="nowrap"!==t(e).getPropertyValue("white-space");let s={left:"left",center:"center",right:"right",justify:"justify"};g.horizontal=s[t(e).getPropertyValue("text-align")]||"center";let u={top:"top",middle:"middle",bottom:"bottom"};g.vertical=u[t(e).getPropertyValue("vertical-align")]||"middle",r.alignment=g;let c={top:T(t(e).getPropertyValue("border-top")),bottom:T(t(e).getPropertyValue("border-bottom")),left:T(t(e).getPropertyValue("border-left")),right:T(t(e).getPropertyValue("border-right"))};r.border=JSON.parse(JSON.stringify(c))}return r}function v(e,t){var r={};return(t||{}).dense&&(r["!data"]=[]),function(e,t,r){var a=t.rows;if(!a)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var n=r||{},i=(e["!data"],0),o=0;if(null!=n.origin)if("number"==typeof n.origin)i=n.origin;else{var l="string"==typeof n.origin?N(n.origin):n.origin;i=l.r,o=l.c}var g=Math.min(n.sheetRows||1e7,a.length),s={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var u=function(e){var t=e.indexOf(":");return-1==t?{s:N(e),e:N(e)}:{s:N(e.slice(0,t)),e:N(e.slice(t+1))}}(e["!ref"]);s.s.r=Math.min(s.s.r,u.s.r),s.s.c=Math.min(s.s.c,u.s.c),s.e.r=Math.max(s.e.r,u.e.r),s.e.c=Math.max(s.e.c,u.e.c),-1==i&&(s.e.r=i=u.e.r+1)}var c=[],m=0,d=e["!rows"]||(e["!rows"]=[]),p=0,f=0,b=0,v=0,T=0,S=0;e["!cols"]||(e["!cols"]=[]);let L=t.getElementsByTagName("colgroup")[0].getElementsByTagName("col");for(let t=0;t<L.length;t++){let r=L[t],a=P(r),n=0;a&&(n=a(r).getPropertyValue("width").match(/\d+/g)[0]),e["!cols"].push({key:String(t),width:(Number(n)/5).toFixed(6)})}for(;p<a.length&&f<g;++p){var E=a[p];if(x(E)){if(n.display)continue;d[f]={hidden:!0}}d[f]?d[f].hpx=E.clientHeight:d[f]={hpx:E.clientHeight};let t=[];for(let e of a)t.push({hpx:e.clientHeight});e["!rows"]=t;var H=E.cells;for(b=v=0;b<H.length;++b){var j=H[b];if(!n.display||!x(j)){var B=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):z(j.innerHTML),I=j.getAttribute("data-z")||j.getAttribute("z");for(m=0;m<c.length;++m){var O=c[m];O.s.c==v+o&&O.s.r<f+i&&f+i<=O.e.r&&(v=O.e.c+1-o,m=-1)}S=+j.getAttribute("colspan")||1,((T=+j.getAttribute("rowspan")||1)>1||S>1)&&c.push({s:{r:f+i,c:v+o},e:{r:f+i+(T||1)-1,c:v+o+(S||1)-1}});var $={t:"s",v:B},R=j.getAttribute("data-t")||j.getAttribute("t")||"";null!=B&&(0==B.length?$.t=R||"z":n.raw||0==B.trim().length||"s"==R||("TRUE"===B?$={t:"b",v:!0}:"FALSE"===B?$={t:"b",v:!1}:isNaN(V(B))?isNaN(F(B).getDate())||($={t:"d",v:M(B)},n.UTC&&($.v=A($.v)),n.cellDates||($={t:"n",v:U($.v)}),$.z=n.dateNF||I||h[14]):$={t:"n",v:V(B)})),void 0===$.z&&null!=I&&($.z=I);var Y="",k=j.getElementsByTagName("A");if(k&&k.length)for(var K=0;K<k.length&&(!k[K].hasAttribute("href")||"#"==(Y=k[K].getAttribute("href")).charAt(0));++K);Y&&"#"!=Y.charAt(0)&&"javascript:"!=Y.slice(0,11).toLowerCase()&&($.l={Target:Y}),$.s=y(j),w(j)&&($.chart=w(j,v+o,f+i)),e["!data"]||(e["!data"]={}),e["!data"][C({c:v+o,r:f+i})]=$,s.e.c<v+o&&(s.e.c=v+o),v+=S}}++f}return c.length&&(e["!merges"]=(e["!merges"]||[]).concat(c)),s.e.r=Math.max(s.e.r,f-1+i),e["!ref"]=D(s),f>=g&&(e["!fullref"]=D((s.e.r=a.length-p+f-1+i,s))),console.log(e),e}(r,e,t)}function D(e,t){return void 0===t||"number"==typeof t?D(e.s,e.e):("string"!=typeof e&&(e=C(e)),"string"!=typeof t&&(t=C(t)),e==t?e:e+":"+t)}function T(e){let t=e.replace(new RegExp(", ","g"),",").split(" "),r={solid:"thin",dotted:"dotted",dashed:"dashDot",double:"double"}[t[1]];if(r)return{style:r,color:{argb:"ff"+S(t[2]).color}}}function S(e){if(e.startsWith("rgba")){let t=e.slice(5,e.length-1).split(","),r=100*Number(t[3].trim()),a="";return a+=((1<<24)+(Number(t[0].trim())<<16)+(Number(t[1].trim())<<8)+Number(t[2].trim())).toString(16).slice(1),{color:a,opacity:r}}let t=e.slice(4,e.length-1).split(","),r="";return r+=((1<<24)+(Number(t[0].trim())<<16)+(Number(t[1].trim())<<8)+Number(t[2].trim())).toString(16).slice(1),{color:r}}function N(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function C(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function x(e){var t="",r=P(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function U(e,t){var r=(e.getTime()-o)/864e5;return t?(r-=1462)<-1402?r-1:r:r<60?r-1:r}function P(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}function A(e){return console.log(new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))),new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function M(e,a){if(e instanceof Date)return e;var n=e.match(t);return n?new Date((a?g:l)+1e3*(60*(60*parseInt(n[1],10)+parseInt(n[2],10))+(n[3]?parseInt(n[3].slice(1),10):0))+(n[4]?parseInt((n[4]+"000").slice(1,4),10):0)):(n=e.match(r))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],0,0,0,0)):(n=e.match(i))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt(n[7].slice(1),10)||0)):new Date(e)}function V(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(a))?(a=a.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(a))?t:t/r):t/r}function F(e){if(c.test(e))return-1==e.indexOf("Z")?A(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),a=r.match(s);if(a)return function(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,"p"==e[7]?12:0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),0,0,0))}(a);if(a=r.match(u))return function(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}(a);if(a=r.match(i))return new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],a[6]&&parseInt(a[6].slice(1),10)||0,a[7]&&parseInt(a[7].slice(1),10)||0));var n=new Date(m&&-1==e.indexOf("UTC")?e+" UTC":e),o=new Date(NaN),l=n.getYear(),g=(n.getMonth(),n.getDate());if(isNaN(g))return o;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==d.indexOf(t))return o}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return o;return l<0||l>8099||e.match(/[^-0-9:,\/\\\ ]/)?o:n}var L,z=(L=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]})),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<L.length;++r)t=t.replace(L[r][0],L[r][1]);return t})})();var i=n.F;export{i as generateExcel};
//# sourceMappingURL=cx-html2excel.min.mjs.map