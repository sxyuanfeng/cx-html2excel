{"version":3,"file":"cx-html2excel.min.mjs","mappings":"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","sources":["webpack://cx-html2excel/external module {\"root\":\"ExcelJS\",\"commonjs\":\"exceljs\",\"commonjs2\":\"exceljs\",\"amd\":\"exceljs\",\"module\":\"exceljs\"}","webpack://cx-html2excel/webpack/bootstrap","webpack://cx-html2excel/webpack/runtime/define property getters","webpack://cx-html2excel/webpack/runtime/hasOwnProperty shorthand","webpack://cx-html2excel/./src/html2excel.js"],"sourcesContent":["var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_exceljs__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","/*\r\n * @Author: xujiang\r\n * @Date: 2024-02-28 15:59:48\r\n * @LastEditors: xujiang\r\n * Copyright (c) 2024 by xujiang/cicc, All Rights Reserved.\r\n */\r\n\r\nconst ExcelJS = require('exceljs');\r\n\r\nvar pdre1 = /^(\\d+):(\\d+)(:\\d+)?(\\.\\d+)?$/; // HH:MM[:SS[.UUU]]\r\nvar pdre2 = /^(\\d+)-(\\d+)-(\\d+)$/; // YYYY-mm-dd\r\nvar pdre3 = /^(\\d+)-(\\d+)-(\\d+)[T ](\\d+):(\\d+)(:\\d+)?(\\.\\d+)?$/; // YYYY-mm-dd(T or space)HH:MM[:SS[.UUU]], sans \"Z\"\r\n\r\nvar dnthresh  = Date.UTC(1899, 11, 30, 0, 0, 0); // -2209161600000\r\nvar dnthresh1 = Date.UTC(1899, 11, 31, 0, 0, 0); // -2209075200000\r\nvar dnthresh2 = Date.UTC(1904, 0, 1, 0, 0, 0); // -2209075200000\r\n\r\nvar FDRE1 = /^(0?\\d|1[0-2])(?:|:([0-5]?\\d)(?:|(\\.\\d+)(?:|:([0-5]?\\d))|:([0-5]?\\d)(|\\.\\d+)))\\s+([ap])m?$/;\r\nvar FDRE2 = /^([01]?\\d|2[0-3])(?:|:([0-5]?\\d)(?:|(\\.\\d+)(?:|:([0-5]?\\d))|:([0-5]?\\d)(|\\.\\d+)))$/;\r\nvar FDISO = /^(\\d+)-(\\d+)-(\\d+)[T ](\\d+):(\\d+)(:\\d+)(\\.\\d+)?[Z]?$/; // YYYY-mm-dd(T or space)HH:MM:SS[.UUU][Z]\r\n\r\nvar utc_append_works = new Date(\"6/9/69 00:00 UTC\").valueOf() == -17798400000;\r\n\r\nvar lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\r\n\r\nvar table_fmt = {\r\n\t0:  'General',\r\n\t1:  '0',\r\n\t2:  '0.00',\r\n\t3:  '#,##0',\r\n\t4:  '#,##0.00',\r\n\t9:  '0%',\r\n\t10: '0.00%',\r\n\t11: '0.00E+00',\r\n\t12: '# ?/?',\r\n\t13: '# ??/??',\r\n\t14: 'm/d/yy',\r\n\t15: 'd-mmm-yy',\r\n\t16: 'd-mmm',\r\n\t17: 'mmm-yy',\r\n\t18: 'h:mm AM/PM',\r\n\t19: 'h:mm:ss AM/PM',\r\n\t20: 'h:mm',\r\n\t21: 'h:mm:ss',\r\n\t22: 'm/d/yy h:mm',\r\n\t37: '#,##0 ;(#,##0)',\r\n\t38: '#,##0 ;[Red](#,##0)',\r\n\t39: '#,##0.00;(#,##0.00)',\r\n\t40: '#,##0.00;[Red](#,##0.00)',\r\n\t45: 'mm:ss',\r\n\t46: '[h]:mm:ss',\r\n\t47: 'mmss.0',\r\n\t48: '##0.0E+0',\r\n\t49: '@',\r\n\t56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\r\n};\r\n\r\nconst defaultOptions = {\r\n\trows: true,\r\n\tfont: true,\r\n\talignment: true,\r\n\tborder: true,\r\n\tnumfmt: true,\r\n\tchart: true\r\n}\r\n\r\nexport function generateExcel(tables, userOptions) {\r\n\tconst ops = { ...defaultOptions, ...userOptions };\r\n\tlet workbook = new ExcelJS.Workbook();\r\n\tfor (let table of tables) {\r\n\t\tlet xlsx = parse_dom_table(table.elet, ops);\r\n\t\tlet worksheet = workbook.addWorksheet(table.name);\r\n\t\tworksheet.columns = xlsx[\"!cols\"];\r\n\t\tif (ops.rows) {\r\n\t\t\tlet rows = xlsx[\"!rows\"];\r\n\t\t\tfor (let i = 0; i < rows.length; i++) {\r\n\t\t\t\tlet row = rows[i];\r\n\t\t\t\tworksheet.getRow(i + 1).height = row.hpx;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet merges = xlsx[\"!merges\"];\r\n\t\tfor (let merge of merges) {\r\n\t\t\tworksheet.mergeCells(encode_range(merge));\r\n\t\t}\r\n\t\tlet data = xlsx[\"!data\"];\r\n\t\tfor (let key in data) {\r\n\t\t\tlet cell = worksheet.getCell(key);\r\n\t\t\tcell.value = data[key].v;\r\n\t\t\tif (ops.font) cell.font = data[key].s.font;\r\n\t\t\tif (ops.alignment) cell.alignment = data[key].s.alignment;\r\n\t\t\tif (ops.border) cell.border = data[key].s.border;\r\n\t\t\tif (ops.numfmt) cell.numFmt = data[key].s.numfmt;\r\n\t\t\tif (ops.chart && data[key].chart) {\r\n\t\t\t\tconst imageId = workbook.addImage({\r\n\t\t\t\t\tbase64: data[key].chart.base64,\r\n\t\t\t\t\textension: 'png',\r\n\t\t\t\t});\r\n\t\t\t\tworksheet.addImage(imageId, {\r\n\t\t\t\t\ttl: {col: decode_cell(key).c, row: decode_cell(key).r},\r\n\t\t\t\t\text: { width: data[key].chart.width, height: data[key].chart.height }\r\n\t\t\t\t});\r\n\t\t\t\t// worksheet.addImage(imageId, data[key].chart.range);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn workbook.xlsx.writeBuffer().then(buffer => {\r\n    return buffer;\r\n  });\r\n}\r\n\r\nfunction sheet_add_dom(ws, table, _opts) {\r\n\tvar rows = table.rows;\r\n\tif(!rows) {\r\n\t\t/* not an HTML TABLE */\r\n\t\tthrow \"Unsupported origin when \" + table.tagName + \" is not a TABLE\";\r\n\t}\r\n\r\n\tvar opts = _opts || {};\r\n\tvar dense = ws[\"!data\"] != null;\r\n\tvar or_R = 0, or_C = 0;\r\n\tif(opts.origin != null) {\r\n\t\tif(typeof opts.origin == 'number') or_R = opts.origin;\r\n\t\telse {\r\n\t\t\tvar _origin = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\r\n\t\t\tor_R = _origin.r; or_C = _origin.c;\r\n\t\t}\r\n\t}\r\n\r\n\tvar sheetRows = Math.min(opts.sheetRows||10000000, rows.length);\r\n\tvar range = {s:{r:0,c:0},e:{r:or_R,c:or_C}};\r\n\tif(ws[\"!ref\"]) {\r\n\t\tvar _range = decode_range(ws[\"!ref\"]);\r\n\t\trange.s.r = Math.min(range.s.r, _range.s.r);\r\n\t\trange.s.c = Math.min(range.s.c, _range.s.c);\r\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\r\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\r\n\t\tif(or_R == -1) range.e.r = or_R = _range.e.r + 1;\r\n\t}\r\n\tvar merges = [], midx = 0;\r\n\tvar rowinfo = ws[\"!rows\"] || (ws[\"!rows\"] = []);\r\n\tvar _R = 0, R = 0, _C = 0, C = 0, RS = 0, CS = 0;\r\n\tif(!ws[\"!cols\"]) ws['!cols'] = [];\r\n\tlet colgroupElem = table.getElementsByTagName('colgroup')[0];\r\n\tlet colElems = colgroupElem.getElementsByTagName('col');\r\n\tfor (let i = 0; i < colElems.length; i++) {\r\n\t\tlet colElem = colElems[i];\r\n\t\tlet get_computed_style = get_get_computed_style_function(colElem);\r\n\t\tlet width = 0;\r\n\t\tif(get_computed_style) width = get_computed_style(colElem).getPropertyValue('width').match(/\\d+/g)[0];\r\n\t\tws['!cols'].push({key: String(i), width: (Number(width) / 5).toFixed(6)});\r\n\t}\r\n\tfor(; _R < rows.length && R < sheetRows; ++_R) {\r\n\t\tvar row = rows[_R];\r\n\t\tif (is_dom_element_hidden(row)) {\r\n\t\t\tif (opts.display) continue;\r\n\t\t\trowinfo[R] = {hidden: true};\r\n\t\t}\r\n\t\tif (rowinfo[R]) {\r\n\t\t\trowinfo[R].hpx = row.clientHeight;\r\n\t\t} else {\r\n\t\t\trowinfo[R] = {hpx: row.clientHeight};\r\n\t\t}\r\n\t\tlet trHeights = []\r\n\t\tfor (let tr of rows) {\r\n\t\t\ttrHeights.push({hpx: tr.clientHeight})\r\n\t\t}\r\n\t\tws[\"!rows\"] = trHeights\r\n\t\tvar elts = (row.cells);\r\n\t\tfor(_C = C = 0; _C < elts.length; ++_C) {\r\n\t\t\tvar elt = elts[_C];\r\n\t\t\tif (opts.display && is_dom_element_hidden(elt)) continue;\r\n\t\t\tvar v = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\r\n\t\t\tvar z = elt.getAttribute('data-z') || elt.getAttribute('z');\r\n\t\t\tvar numfmt = elt.getAttribute('data-numfmt') || elt.getAttribute('numfmt');\r\n\t\t\tfor(midx = 0; midx < merges.length; ++midx) {\r\n\t\t\t\tvar m = merges[midx];\r\n\t\t\t\tif(m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) { C = m.e.c+1 - or_C; midx = -1; }\r\n\t\t\t}\r\n\t\t\t/* TODO: figure out how to extract nonstandard mso- style */\r\n\t\t\tCS = +elt.getAttribute(\"colspan\") || 1;\r\n\t\t\tif( ((RS = (+elt.getAttribute(\"rowspan\") || 1)))>1 || CS>1) merges.push({s:{r:R + or_R,c:C + or_C},e:{r:R + or_R + (RS||1) - 1, c:C + or_C + (CS||1) - 1}});\r\n\t\t\tvar o = {t:'s', v:v};\r\n\t\t\tvar _t = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\r\n\t\t\tif(v != null) {\r\n\t\t\t\tif(v.length == 0) o.t = _t || 'z';\r\n\t\t\t\telse if(opts.raw || v.trim().length == 0 || _t == \"s\"){}\r\n\t\t\t\telse if(v === 'TRUE') o = {t:'b', v:true};\r\n\t\t\t\telse if(v === 'FALSE') o = {t:'b', v:false};\r\n\t\t\t\telse if(!isNaN(fuzzynum(v))) o = {t:'n', v:fuzzynum(v)};\r\n\t\t\t\telse if(!isNaN(fuzzydate(v).getDate())) {\r\n\t\t\t\t\to = ({t:'d', v:parseDate(v)});\r\n\t\t\t\t\tif(opts.UTC) o.v = local_to_utc(o.v);\r\n\t\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)});\r\n\t\t\t\t\to.z = opts.dateNF || table_fmt[14];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(o.z === undefined && z != null) o.z = z;\r\n\t\t\t/* The first link is used.  Links are assumed to be fully specified.\r\n\t\t\t * TODO: The right way to process relative links is to make a new <a> */\r\n\t\t\tvar l = \"\", Aelts = elt.getElementsByTagName(\"A\");\r\n\t\t\tif(Aelts && Aelts.length) for(var Aelti = 0; Aelti < Aelts.length; ++Aelti)\tif(Aelts[Aelti].hasAttribute(\"href\")) {\r\n\t\t\t\tl = Aelts[Aelti].getAttribute(\"href\"); if(l.charAt(0) != \"#\") break;\r\n\t\t\t}\r\n\t\t\tif(l && l.charAt(0) != \"#\" &&\tl.slice(0, 11).toLowerCase() != 'javascript:') o.l = ({ Target: l });\r\n\t\t\to.s = setCellStyle(elt);\r\n\t\t\tif (parseChart(elt)) {\r\n\t\t\t\to.chart = parseChart(elt, C + or_C, R + or_R);\r\n\t\t\t}\r\n\t\t\to.s.numfmt = numfmt;\r\n\t\t\t// if(dense) { if(!ws[\"!data\"][R + or_R]) ws[\"!data\"][R + or_R] = []; ws[\"!data\"][R + or_R][C + or_C] = o; }\r\n\t\t\t// else ws[encode_cell({c:C + or_C, r:R + or_R})] = o;\r\n\t\t\tif (!ws[\"!data\"]) {\r\n\t\t\t\tws[\"!data\"] = {};\r\n\t\t\t}\r\n\t\t\tws[\"!data\"][encode_cell({c:C + or_C, r:R + or_R})] = o;\r\n\t\t\tif(range.e.c < C + or_C) range.e.c = C + or_C;\r\n\t\t\tC += CS;\r\n\t\t}\r\n\t\t++R;\r\n\t}\r\n\tif(merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\r\n\trange.e.r = Math.max(range.e.r, R - 1 + or_R);\r\n\tws['!ref'] = encode_range(range);\r\n\tif(R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length-_R+R-1 + or_R,range)); // We can count the real number of rows to parse but we don't to improve the performance\r\n\tconsole.log(ws)\r\n\treturn ws;\r\n}\r\n\r\nfunction parseChart(dom, cs, rs) {\r\n\tlet get_computed_style = get_get_computed_style_function(dom);\r\n\tlet rowSpan = dom.getAttribute(\"rowspan\") || 1;\r\n\tlet colSpan = dom.getAttribute(\"colspan\") || 1;\r\n\tlet re = rs + Number(rowSpan);\r\n\tlet ce = cs + Number(colSpan);\r\n\tlet range = encode_range({s:{c: cs, r: rs}, e:{c: ce, r: re}});\r\n\tlet imgEles = dom.getElementsByTagName('img');\r\n\tlet canvasEles = dom.getElementsByTagName('canvas');\r\n\tif (imgEles.length > 0) {\r\n\t\tlet imgEle = imgEles[0];\r\n\t\tlet width = 0, height = 0;\r\n\t\tif(get_computed_style) width = get_computed_style(imgEle).getPropertyValue('width').match(/\\d+/g)[0];\r\n\t\tif(get_computed_style) height = get_computed_style(imgEle).getPropertyValue('height').match(/\\d+/g)[0];\r\n\t\t// 创建 Canvas 元素\r\n\t\tconst canvas = document.createElement('canvas');\r\n\t\tcanvas.width = imgEle.width;\r\n\t\tcanvas.height = imgEle.height;\r\n\r\n\t\t// 将图像绘制到 Canvas 上\r\n\t\tconst ctx = canvas.getContext('2d');\r\n\t\tctx.drawImage(imgEle, 0, 0);\r\n\r\n\t\t// 获取 base64 编码的图像数据\r\n\t\tconst base64Image = canvas.toDataURL('image/png');\r\n\t\treturn {width: width, height: height, range: range, base64: base64Image};\r\n\t}\r\n\tif (canvasEles.length > 0) {\r\n\t\tlet canvasEle = canvasEles[0];\r\n\t\tlet width = 0, height = 0;\r\n\t\tif(get_computed_style) width = get_computed_style(canvasEle).getPropertyValue('width').match(/\\d+/g)[0];\r\n\t\tif(get_computed_style) height = get_computed_style(canvasEle).getPropertyValue('height').match(/\\d+/g)[0];\r\n\t\tconst base64Image = canvasEle.toDataURL('image/png');\r\n\t\treturn {width: width, height: height, range: range, base64: base64Image};\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nfunction setCellStyle(dom) {\r\n\tlet get_computed_style = get_get_computed_style_function(dom);\r\n\tlet o = {};\r\n\tif (get_computed_style) {\r\n\t\tlet font = {};\r\n\t\tfont.size = get_computed_style(dom).getPropertyValue('font-size').match(/\\d+/g)[0];\r\n\t\tlet fontName = get_computed_style(dom).getPropertyValue('font-family');\r\n\t\tlet fontNameDict = {SimSun: \"SimSun\"};\r\n\t\tfont.name = fontNameDict[fontName] ?? \"SimSun\";\r\n\t\tfont.bold = get_computed_style(dom).getPropertyValue('font-weight') === '700';\r\n\r\n\t\tlet hex = RGBToHex(get_computed_style(dom).getPropertyValue('color')).color;\r\n\t\tfont.color = { argb: 'ff' + hex };\r\n\t\to.font = font;\r\n\t\tlet alignment = {};\r\n\t\talignment.wrapText = get_computed_style(dom).getPropertyValue('white-space') !== 'nowrap';\r\n\t\t//todo 部分css和excel属性值未匹配\r\n\t\talignment.horizontal = get_computed_style(dom).getPropertyValue('text-align');\r\n\t\talignment.vertical = get_computed_style(dom).getPropertyValue('vertical-align');\r\n\t\to.alignment = alignment;\r\n\t\tlet border = {\r\n\t\t\ttop: parseBorder(get_computed_style(dom).getPropertyValue('border-top')),\r\n\t\t\tbottom: parseBorder(get_computed_style(dom).getPropertyValue('border-bottom')),\r\n\t\t\tleft: parseBorder(get_computed_style(dom).getPropertyValue('border-left')),\r\n\t\t\tright: parseBorder(get_computed_style(dom).getPropertyValue('border-right')),\r\n\t\t};\r\n\t\to.border = JSON.parse(JSON.stringify(border));\r\n\t}\r\n\treturn o;\r\n}\r\n\r\nfunction svg2base64(svgElement) {\r\n\tconst serializer = new XMLSerializer();\r\n\tconst svgXML = serializer.serializeToString(svgElement);\r\n\treturn btoa(svgXML);\r\n}\r\n\r\nfunction parse_dom_table(table, _opts) {\r\n\tvar opts = _opts || {};\r\n\tvar ws = ({}); if(opts.dense) ws[\"!data\"] = [];\r\n\treturn sheet_add_dom(ws, table, _opts);\r\n}\r\n\r\nfunction decode_range(range) {\r\n\tvar idx = range.indexOf(\":\");\r\n\tif(idx == -1) return { s: decode_cell(range), e: decode_cell(range) };\r\n\treturn { s: decode_cell(range.slice(0, idx)), e: decode_cell(range.slice(idx + 1)) };\r\n}\r\n\r\nfunction encode_range(cs,ce) {\r\n\tif(typeof ce === 'undefined' || typeof ce === 'number') {\r\nreturn encode_range(cs.s, cs.e);\r\n\t}\r\nif(typeof cs !== 'string') cs = encode_cell((cs));\r\n\tif(typeof ce !== 'string') ce = encode_cell((ce));\r\nreturn cs == ce ? cs : cs + \":\" + ce;\r\n}\r\n\r\nfunction parseBorder(s) {\r\n\tlet str = s.replace(new RegExp(', ', 'g'), ',')\r\n\tlet arr = str.split(' ');\r\n\tlet dict = {solid: 'thin'};\r\n\tlet style = dict[arr[1]];\r\n\tif (!style) return undefined;\r\n\tlet color = RGBToHex(arr[2]);\r\n\treturn {style, color: {argb: 'ff' + color.color}};\r\n}\r\n\r\nfunction RGBToHex(rgba) {\r\n\tif (rgba.startsWith('rgba')) {\r\n\t\tlet str = rgba.slice(5, rgba.length - 1),\r\n\t\t\tarry = str.split(','),\r\n\t\t\topa = Number(arry[3].trim()) * 100,\r\n\t\t\tstrHex = \"\",\r\n\t\t\tr = Number(arry[0].trim()),\r\n\t\t\tg = Number(arry[1].trim()),\r\n\t\t\tb = Number(arry[2].trim());\r\n\r\n\t\tstrHex += ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\r\n\r\n\t\treturn { color: strHex, opacity: opa };\r\n\t}\r\n\tlet str = rgba.slice(4, rgba.length - 1),\r\n\t\t\tarry = str.split(','),\r\n\t\t\tstrHex = \"\",\r\n\t\t\tr = Number(arry[0].trim()),\r\n\t\t\tg = Number(arry[1].trim()),\r\n\t\t\tb = Number(arry[2].trim());\r\n\r\n\tstrHex += ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\r\n\r\n\treturn { color: strHex };\r\n}\r\n\r\nfunction decode_cell(cstr) {\r\n\tvar R = 0, C = 0;\r\n\tfor(var i = 0; i < cstr.length; ++i) {\r\n\t\tvar cc = cstr.charCodeAt(i);\r\n\t\tif(cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);\r\n\t\telse if(cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\r\n\t}\r\n\treturn { c: C - 1, r:R - 1 };\r\n}\r\n\r\nfunction encode_cell(cell) {\r\n\tvar col = cell.c + 1;\r\n\tvar s=\"\";\r\n\tfor(; col; col=((col-1)/26)|0) s = String.fromCharCode(((col-1)%26) + 65) + s;\r\n\treturn s + (cell.r + 1);\r\n}\r\n\r\nfunction is_dom_element_hidden(element) {\r\n\tvar display = '';\r\n\tvar get_computed_style = get_get_computed_style_function(element);\r\n\tif(get_computed_style) display = get_computed_style(element).getPropertyValue('display');\r\n\tif(!display) display = element.style && element.style.display;\r\n\treturn display === 'none';\r\n}\r\n\r\nfunction datenum(v, date1904) {\r\n\tvar epoch = v.getTime();\r\n\tvar res = (epoch - dnthresh) / (24 * 60 * 60 * 1000);\r\n\tif(date1904) { res -= 1462; return res < -1402 ? res - 1 : res; }\r\n\treturn res < 60 ? res - 1 : res;\r\n}\r\n\r\nfunction get_get_computed_style_function(element) {\r\n\t// The proper getComputedStyle implementation is the one defined in the element window\r\n\tif(element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle;\r\n\t// If it is not available, try to get one from the global namespace\r\n\tif(typeof getComputedStyle === 'function') return getComputedStyle;\r\n\treturn null;\r\n}\r\n\r\nfunction local_to_utc(local) {\r\n\treturn new Date(Date.UTC(local.getFullYear(), local.getMonth(), local.getDate(), local.getHours(), local.getMinutes(), local.getSeconds(), local.getMilliseconds()));\r\n}\r\n\r\nfunction parseDate(str, date1904) {\r\n\tif(str instanceof Date) return str;\r\n\tvar m = str.match(pdre1);\r\n\tif(m) return new Date((date1904 ? dnthresh2 : dnthresh1) + ((parseInt(m[1], 10)*60 + parseInt(m[2], 10))*60 + (m[3] ? parseInt(m[3].slice(1), 10) : 0))*1000 + (m[4] ? parseInt((m[4]+\"000\").slice(1,4), 10) : 0));\r\n\tm = str.match(pdre2);\r\n\tif(m) return new Date(Date.UTC(+m[1], +m[2]-1, +m[3], 0, 0, 0, 0));\r\n\t/* TODO: 1900-02-29T00:00:00.000 should return a flag to treat as a date code (affects xlml) */\r\n\tm = str.match(pdre3);\r\n\tif(m) return new Date(Date.UTC(+m[1], +m[2]-1, +m[3], +m[4], +m[5], ((m[6] && parseInt(m[6].slice(1), 10))|| 0), ((m[7] && parseInt(m[7].slice(1), 10))||0)));\r\n\tvar d = new Date(str);\r\n\treturn d;\r\n}\r\n\r\nfunction fuzzynum(s) {\r\n\tvar v = Number(s);\r\n\tif(!isNaN(v)) return isFinite(v) ? v : NaN;\r\n\tif(!/\\d/.test(s)) return v;\r\n\tvar wt = 1;\r\n\tvar ss = s.replace(/([\\d]),([\\d])/g,\"$1$2\").replace(/[$]/g,\"\").replace(/[%]/g, function() { wt *= 100; return \"\";});\r\n\tif(!isNaN(v = Number(ss))) return v / wt;\r\n\tss = ss.replace(/[(](.*)[)]/,function($$, $1) { wt = -wt; return $1;});\r\n\tif(!isNaN(v = Number(ss))) return v / wt;\r\n\treturn v;\r\n}\r\n\r\nfunction fuzzytime1(M)  {\r\n\tif(!M[2]) return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), 0, 0, 0));\r\n\tif(M[3]) {\r\n\t\t\tif(M[4]) return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], +M[4], parseFloat(M[3])*1000));\r\n\t\t\telse return new Date(Date.UTC(1899,11,31,(M[7] == \"p\" ? 12 : 0), +M[1], +M[2], parseFloat(M[3])*1000));\r\n\t}\r\n\telse if(M[5]) return new Date(Date.UTC(1899,11,31, (+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], +M[5], M[6] ? parseFloat(M[6]) * 1000 : 0));\r\n\telse return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], 0, 0));\r\n}\r\nfunction fuzzytime2(M)  {\r\n\tif(!M[2]) return new Date(Date.UTC(1899,11,31,+M[1], 0, 0, 0));\r\n\tif(M[3]) {\r\n\t\t\tif(M[4]) return new Date(Date.UTC(1899,11,31,+M[1], +M[2], +M[4], parseFloat(M[3])*1000));\r\n\t\t\telse return new Date(Date.UTC(1899,11,31,0, +M[1], +M[2], parseFloat(M[3])*1000));\r\n\t}\r\n\telse if(M[5]) return new Date(Date.UTC(1899,11,31, +M[1], +M[2], +M[5], M[6] ? parseFloat(M[6]) * 1000 : 0));\r\n\telse return new Date(Date.UTC(1899,11,31,+M[1], +M[2], 0, 0));\r\n}\r\n\r\nfunction fuzzydate(s) {\r\n\t// See issue 2863 -- this is technically not supported in Excel but is otherwise useful\r\n\tif(FDISO.test(s)) return s.indexOf(\"Z\") == -1 ? local_to_utc(new Date(s)) : new Date(s);\r\n\tvar lower = s.toLowerCase();\r\n\tvar lnos = lower.replace(/\\s+/g, \" \").trim();\r\n\tvar M = lnos.match(FDRE1);\r\n\tif(M) return fuzzytime1(M);\r\n\tM = lnos.match(FDRE2);\r\n\tif(M) return fuzzytime2(M);\r\n\tM = lnos.match(pdre3);\r\n\tif(M) return new Date(Date.UTC(+M[1], +M[2]-1, +M[3], +M[4], +M[5], ((M[6] && parseInt(M[6].slice(1), 10))|| 0), ((M[7] && parseInt(M[7].slice(1), 10))||0)));\r\n\tvar o = new Date(utc_append_works && s.indexOf(\"UTC\") == -1 ? s + \" UTC\": s), n = new Date(NaN);\r\n\tvar y = o.getYear(), m = o.getMonth(), d = o.getDate();\r\n\tif(isNaN(d)) return n;\r\n\tif(lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\r\n\t\tlower = lower.replace(/[^a-z]/g,\"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,\"\");\r\n\t\tif(lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\r\n\t} else if(lower.replace(/[ap]m?/, \"\").match(/[a-z]/)) return n;\r\n\tif(y < 0 || y > 8099 || s.match(/[^-0-9:,\\/\\\\\\ ]/)) return n;\r\n\treturn o;\r\n}\r\n\r\nvar htmldecode = (function() {\r\n\tvar entities = [\r\n\t\t['nbsp', ' '], ['middot', '·'],\r\n\t\t['quot', '\"'], ['apos', \"'\"], ['gt',   '>'], ['lt',   '<'], ['amp',  '&']\r\n\t].map(function(x) { return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]]; });\r\n\treturn function htmldecode(str) {\r\n\t\tvar o = str\r\n\t\t\t\t// Remove new lines and spaces from start of content\r\n\t\t\t\t.replace(/^[\\t\\n\\r ]+/, \"\")\r\n\t\t\t\t// Remove new lines and spaces from end of content\r\n\t\t\t\t.replace(/[\\t\\n\\r ]+$/,\"\")\r\n\t\t\t\t// Added line which removes any white space characters after and before html tags\r\n\t\t\t\t.replace(/>\\s+/g,\">\").replace(/\\s+</g,\"<\")\r\n\t\t\t\t// Replace remaining new lines and spaces with space\r\n\t\t\t\t.replace(/[\\t\\n\\r ]+/g, \" \")\r\n\t\t\t\t// Replace <br> tags with new lines\r\n\t\t\t\t.replace(/<\\s*[bB][rR]\\s*\\/?>/g,\"\\n\")\r\n\t\t\t\t// Strip HTML elements\r\n\t\t\t\t.replace(/<[^>]*>/g,\"\");\r\n\t\tfor(var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\r\n\t\treturn o;\r\n\t};\r\n})();\r\n"],"names":["module","exports","__WEBPACK_EXTERNAL_MODULE_exceljs__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","ExcelJS","pdre1","pdre2","pdre3","dnthresh","Date","UTC","dnthresh1","dnthresh2","FDRE1","FDRE2","FDISO","utc_append_works","valueOf","lower_months","table_fmt","defaultOptions","rows","font","alignment","border","numfmt","chart","generateExcel","tables","userOptions","ops","workbook","Workbook","table","xlsx","parse_dom_table","elet","worksheet","addWorksheet","name","columns","i","length","row","getRow","height","hpx","merges","merge","mergeCells","encode_range","data","cell","getCell","value","v","s","numFmt","imageId","addImage","base64","extension","tl","col","decode_cell","c","r","ext","width","writeBuffer","then","buffer","parseChart","dom","cs","rs","get_computed_style","get_get_computed_style_function","rowSpan","getAttribute","colSpan","re","Number","range","e","imgEles","getElementsByTagName","canvasEles","imgEle","getPropertyValue","match","canvas","document","createElement","getContext","drawImage","toDataURL","canvasEle","setCellStyle","size","fontName","fontNameDict","SimSun","bold","hex","RGBToHex","color","argb","wrapText","horizontal","vertical","top","parseBorder","bottom","left","right","JSON","parse","stringify","_opts","ws","dense","tagName","opts","or_R","or_C","origin","_origin","sheetRows","Math","min","_range","idx","indexOf","slice","decode_range","max","midx","rowinfo","_R","R","_C","C","RS","CS","colElems","colElem","push","String","toFixed","is_dom_element_hidden","display","hidden","clientHeight","trHeights","tr","elts","elt","hasAttribute","htmldecode","innerHTML","z","m","t","_t","raw","trim","isNaN","fuzzynum","fuzzydate","getDate","parseDate","local_to_utc","cellDates","datenum","dateNF","l","Aelts","Aelti","charAt","toLowerCase","Target","encode_cell","concat","console","log","sheet_add_dom","ce","arr","replace","RegExp","split","style","solid","rgba","startsWith","arry","opa","strHex","toString","opacity","cstr","cc","charCodeAt","fromCharCode","element","date1904","res","getTime","ownerDocument","defaultView","getComputedStyle","local","getFullYear","getMonth","getHours","getMinutes","getSeconds","getMilliseconds","str","parseInt","isFinite","NaN","test","wt","ss","$$","$1","lower","lnos","M","parseFloat","fuzzytime1","fuzzytime2","n","y","getYear","entities","map","x"],"sourceRoot":""}