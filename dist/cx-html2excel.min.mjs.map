{"version":3,"file":"cx-html2excel.min.mjs","mappings":"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","sources":["webpack://cx-html2excel/external module {\"root\":\"ExcelJS\",\"commonjs\":\"exceljs\",\"commonjs2\":\"exceljs\",\"amd\":\"exceljs\",\"module\":\"exceljs\"}","webpack://cx-html2excel/webpack/bootstrap","webpack://cx-html2excel/webpack/runtime/define property getters","webpack://cx-html2excel/webpack/runtime/hasOwnProperty shorthand","webpack://cx-html2excel/./src/html2excel.js"],"sourcesContent":["var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_exceljs__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const ExcelJS = require('exceljs');\r\n\r\nvar pdre1 = /^(\\d+):(\\d+)(:\\d+)?(\\.\\d+)?$/; // HH:MM[:SS[.UUU]]\r\nvar pdre2 = /^(\\d+)-(\\d+)-(\\d+)$/; // YYYY-mm-dd\r\nvar pdre3 = /^(\\d+)-(\\d+)-(\\d+)[T ](\\d+):(\\d+)(:\\d+)?(\\.\\d+)?$/; // YYYY-mm-dd(T or space)HH:MM[:SS[.UUU]], sans \"Z\"\r\n\r\nvar dnthresh  = Date.UTC(1899, 11, 30, 0, 0, 0); // -2209161600000\r\nvar dnthresh1 = Date.UTC(1899, 11, 31, 0, 0, 0); // -2209075200000\r\nvar dnthresh2 = Date.UTC(1904, 0, 1, 0, 0, 0); // -2209075200000\r\n\r\nvar FDRE1 = /^(0?\\d|1[0-2])(?:|:([0-5]?\\d)(?:|(\\.\\d+)(?:|:([0-5]?\\d))|:([0-5]?\\d)(|\\.\\d+)))\\s+([ap])m?$/;\r\nvar FDRE2 = /^([01]?\\d|2[0-3])(?:|:([0-5]?\\d)(?:|(\\.\\d+)(?:|:([0-5]?\\d))|:([0-5]?\\d)(|\\.\\d+)))$/;\r\nvar FDISO = /^(\\d+)-(\\d+)-(\\d+)[T ](\\d+):(\\d+)(:\\d+)(\\.\\d+)?[Z]?$/; // YYYY-mm-dd(T or space)HH:MM:SS[.UUU][Z]\r\n\r\nvar utc_append_works = new Date(\"6/9/69 00:00 UTC\").valueOf() == -17798400000;\r\n\r\nvar lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\r\n\r\nvar table_fmt = {\r\n\t0:  'General',\r\n\t1:  '0',\r\n\t2:  '0.00',\r\n\t3:  '#,##0',\r\n\t4:  '#,##0.00',\r\n\t9:  '0%',\r\n\t10: '0.00%',\r\n\t11: '0.00E+00',\r\n\t12: '# ?/?',\r\n\t13: '# ??/??',\r\n\t14: 'm/d/yy',\r\n\t15: 'd-mmm-yy',\r\n\t16: 'd-mmm',\r\n\t17: 'mmm-yy',\r\n\t18: 'h:mm AM/PM',\r\n\t19: 'h:mm:ss AM/PM',\r\n\t20: 'h:mm',\r\n\t21: 'h:mm:ss',\r\n\t22: 'm/d/yy h:mm',\r\n\t37: '#,##0 ;(#,##0)',\r\n\t38: '#,##0 ;[Red](#,##0)',\r\n\t39: '#,##0.00;(#,##0.00)',\r\n\t40: '#,##0.00;[Red](#,##0.00)',\r\n\t45: 'mm:ss',\r\n\t46: '[h]:mm:ss',\r\n\t47: 'mmss.0',\r\n\t48: '##0.0E+0',\r\n\t49: '@',\r\n\t56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\r\n};\r\n\r\nconst fontFamilyDict = [\r\n\t'SimSun', 'SimHei', 'Microsoft YaHei', 'Microsoft JhengHei', 'NSimSun', 'PMingLiU', 'MingLiU', 'DFKai-SB', 'FangSong', 'KaiTi', 'FangSong_GB2312', 'KaiTi_GB2312',\r\n\t'STHeiti Light', 'STHeiti', 'STKaiti', 'STSong', 'STFangsong', 'LiHei Pro Medium', 'LiSong Pro Light', 'BiauKai', 'Apple LiGothic Medium', 'Apple LiSung Light',\r\n\t'LiSu', 'YouYuan', 'STXihei', 'STZhongsong', 'FZShuTi', 'FZYaoti', 'STCaiyun', 'STHupo', 'STLiti', 'STXingkai', 'STXinwei'\r\n]\r\n\r\nconst defaultOptions = {\r\n\trows: true,\r\n\tfont: true,\r\n\talignment: true,\r\n\tborder: true,\r\n\tnumfmt: true,\r\n\tchart: true\r\n}\r\n\r\nexport function generateExcel(tables, userOptions) {\r\n\tconst ops = { ...defaultOptions, ...userOptions };\r\n\tlet workbook = new ExcelJS.Workbook();\r\n\tfor (let table of tables) {\r\n\t\tlet xlsx = parse_dom_table(table.elet, ops);\r\n\t\tlet worksheet = workbook.addWorksheet(table.name);\r\n\t\tworksheet.columns = xlsx[\"!cols\"];\r\n\t\tif (ops.rows) {\r\n\t\t\tlet rows = xlsx[\"!rows\"];\r\n\t\t\tfor (let i = 0; i < rows.length; i++) {\r\n\t\t\t\tlet row = rows[i];\r\n\t\t\t\tworksheet.getRow(i + 1).height = row.hpx;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet merges = xlsx[\"!merges\"];\r\n\t\tfor (let merge of merges) {\r\n\t\t\tworksheet.mergeCells(encode_range(merge));\r\n\t\t}\r\n\t\tlet data = xlsx[\"!data\"];\r\n\t\tfor (let key in data) {\r\n\t\t\tlet cell = worksheet.getCell(key);\r\n\t\t\tcell.value = data[key].v;\r\n\t\t\tif (ops.font) cell.font = data[key].s.font;\r\n\t\t\tif (ops.alignment) cell.alignment = data[key].s.alignment;\r\n\t\t\tif (ops.border) cell.border = data[key].s.border;\r\n\t\t\tif (ops.numfmt) cell.numFmt = data[key].z;\r\n\t\t\tif (ops.chart && data[key].chart) {\r\n\t\t\t\tconst imageId = workbook.addImage({\r\n\t\t\t\t\tbase64: data[key].chart.base64,\r\n\t\t\t\t\textension: 'png',\r\n\t\t\t\t});\r\n\t\t\t\tworksheet.addImage(imageId, {\r\n\t\t\t\t\ttl: {col: decode_cell(key).c, row: decode_cell(key).r},\r\n\t\t\t\t\text: { width: data[key].chart.width, height: data[key].chart.height }\r\n\t\t\t\t});\r\n\t\t\t\t// worksheet.addImage(imageId, data[key].chart.range);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn workbook.xlsx.writeBuffer().then(buffer => {\r\n    return buffer;\r\n  });\r\n}\r\n\r\nfunction sheet_add_dom(ws, table, _opts) {\r\n\tvar rows = table.rows;\r\n\tif(!rows) {\r\n\t\t/* not an HTML TABLE */\r\n\t\tthrow \"Unsupported origin when \" + table.tagName + \" is not a TABLE\";\r\n\t}\r\n\r\n\tvar opts = _opts || {};\r\n\tvar dense = ws[\"!data\"] != null;\r\n\tvar or_R = 0, or_C = 0;\r\n\tif(opts.origin != null) {\r\n\t\tif(typeof opts.origin == 'number') or_R = opts.origin;\r\n\t\telse {\r\n\t\t\tvar _origin = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\r\n\t\t\tor_R = _origin.r; or_C = _origin.c;\r\n\t\t}\r\n\t}\r\n\r\n\tvar sheetRows = Math.min(opts.sheetRows||10000000, rows.length);\r\n\tvar range = {s:{r:0,c:0},e:{r:or_R,c:or_C}};\r\n\tif(ws[\"!ref\"]) {\r\n\t\tvar _range = decode_range(ws[\"!ref\"]);\r\n\t\trange.s.r = Math.min(range.s.r, _range.s.r);\r\n\t\trange.s.c = Math.min(range.s.c, _range.s.c);\r\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\r\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\r\n\t\tif(or_R == -1) range.e.r = or_R = _range.e.r + 1;\r\n\t}\r\n\tvar merges = [], midx = 0;\r\n\tvar rowinfo = ws[\"!rows\"] || (ws[\"!rows\"] = []);\r\n\tvar _R = 0, R = 0, _C = 0, C = 0, RS = 0, CS = 0;\r\n\tif(!ws[\"!cols\"]) ws['!cols'] = [];\r\n\tlet colgroupElem = table.getElementsByTagName('colgroup')[0];\r\n\tlet colElems = colgroupElem.getElementsByTagName('col');\r\n\tfor (let i = 0; i < colElems.length; i++) {\r\n\t\tlet colElem = colElems[i];\r\n\t\tlet get_computed_style = get_get_computed_style_function(colElem);\r\n\t\tlet width = 0;\r\n\t\tif(get_computed_style) width = get_computed_style(colElem).getPropertyValue('width').match(/\\d+/g)[0];\r\n\t\tws['!cols'].push({key: String(i), width: (Number(width) / 5).toFixed(6)});\r\n\t}\r\n\tfor(; _R < rows.length && R < sheetRows; ++_R) {\r\n\t\tvar row = rows[_R];\r\n\t\tif (is_dom_element_hidden(row)) {\r\n\t\t\tif (opts.display) continue;\r\n\t\t\trowinfo[R] = {hidden: true};\r\n\t\t}\r\n\t\tif (rowinfo[R]) {\r\n\t\t\trowinfo[R].hpx = row.clientHeight;\r\n\t\t} else {\r\n\t\t\trowinfo[R] = {hpx: row.clientHeight};\r\n\t\t}\r\n\t\tlet trHeights = []\r\n\t\tfor (let tr of rows) {\r\n\t\t\ttrHeights.push({hpx: tr.clientHeight})\r\n\t\t}\r\n\t\tws[\"!rows\"] = trHeights\r\n\t\tvar elts = (row.cells);\r\n\t\tfor(_C = C = 0; _C < elts.length; ++_C) {\r\n\t\t\tvar elt = elts[_C];\r\n\t\t\tif (opts.display && is_dom_element_hidden(elt)) continue;\r\n\t\t\tvar v = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\r\n\t\t\tvar z = elt.getAttribute('data-z') || elt.getAttribute('z');\r\n\t\t\t// var numfmt = elt.getAttribute('data-numfmt') || elt.getAttribute('numfmt');\r\n\t\t\tfor(midx = 0; midx < merges.length; ++midx) {\r\n\t\t\t\tvar m = merges[midx];\r\n\t\t\t\tif(m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) { C = m.e.c+1 - or_C; midx = -1; }\r\n\t\t\t}\r\n\t\t\t/* TODO: figure out how to extract nonstandard mso- style */\r\n\t\t\tCS = +elt.getAttribute(\"colspan\") || 1;\r\n\t\t\tif( ((RS = (+elt.getAttribute(\"rowspan\") || 1)))>1 || CS>1) merges.push({s:{r:R + or_R,c:C + or_C},e:{r:R + or_R + (RS||1) - 1, c:C + or_C + (CS||1) - 1}});\r\n\t\t\tvar o = {t:'s', v:v};\r\n\t\t\tvar _t = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\r\n\t\t\tif(v != null) {\r\n\t\t\t\tif(v.length == 0) o.t = _t || 'z';\r\n\t\t\t\telse if(opts.raw || v.trim().length == 0 || _t == \"s\"){}\r\n\t\t\t\telse if(v === 'TRUE') o = {t:'b', v:true};\r\n\t\t\t\telse if(v === 'FALSE') o = {t:'b', v:false};\r\n\t\t\t\telse if(!isNaN(fuzzynum(v))) o = {t:'n', v:fuzzynum(v)};\r\n\t\t\t\telse if(!isNaN(fuzzydate(v).getDate())) {\r\n\t\t\t\t\to = ({t:'d', v:parseDate(v)});\r\n\t\t\t\t\tif(opts.UTC) o.v = local_to_utc(o.v);\r\n\t\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)});\r\n\t\t\t\t\t// o.z = opts.dateNF || table_fmt[14];\r\n\t\t\t\t\to.z = opts.dateNF || z || table_fmt[14];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(o.z === undefined && z != null) o.z = z;\r\n\t\t\t/* The first link is used.  Links are assumed to be fully specified.\r\n\t\t\t * TODO: The right way to process relative links is to make a new <a> */\r\n\t\t\tvar l = \"\", Aelts = elt.getElementsByTagName(\"A\");\r\n\t\t\tif(Aelts && Aelts.length) for(var Aelti = 0; Aelti < Aelts.length; ++Aelti)\tif(Aelts[Aelti].hasAttribute(\"href\")) {\r\n\t\t\t\tl = Aelts[Aelti].getAttribute(\"href\"); if(l.charAt(0) != \"#\") break;\r\n\t\t\t}\r\n\t\t\tif(l && l.charAt(0) != \"#\" &&\tl.slice(0, 11).toLowerCase() != 'javascript:') o.l = ({ Target: l });\r\n\t\t\to.s = setCellStyle(elt);\r\n\t\t\tif (parseChart(elt)) {\r\n\t\t\t\to.chart = parseChart(elt, C + or_C, R + or_R);\r\n\t\t\t}\r\n\t\t\t// o.s.numfmt = numfmt;\r\n\t\t\t// if(dense) { if(!ws[\"!data\"][R + or_R]) ws[\"!data\"][R + or_R] = []; ws[\"!data\"][R + or_R][C + or_C] = o; }\r\n\t\t\t// else ws[encode_cell({c:C + or_C, r:R + or_R})] = o;\r\n\t\t\tif (!ws[\"!data\"]) {\r\n\t\t\t\tws[\"!data\"] = {};\r\n\t\t\t}\r\n\t\t\tws[\"!data\"][encode_cell({c:C + or_C, r:R + or_R})] = o;\r\n\t\t\tif(range.e.c < C + or_C) range.e.c = C + or_C;\r\n\t\t\tC += CS;\r\n\t\t}\r\n\t\t++R;\r\n\t}\r\n\tif(merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\r\n\trange.e.r = Math.max(range.e.r, R - 1 + or_R);\r\n\tws['!ref'] = encode_range(range);\r\n\tif(R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length-_R+R-1 + or_R,range)); // We can count the real number of rows to parse but we don't to improve the performance\r\n\tconsole.log(ws)\r\n\treturn ws;\r\n}\r\n\r\nfunction parseChart(dom, cs, rs) {\r\n\tlet get_computed_style = get_get_computed_style_function(dom);\r\n\tlet rowSpan = dom.getAttribute(\"rowspan\") || 1;\r\n\tlet colSpan = dom.getAttribute(\"colspan\") || 1;\r\n\tlet re = rs + Number(rowSpan);\r\n\tlet ce = cs + Number(colSpan);\r\n\tlet range = encode_range({s:{c: cs, r: rs}, e:{c: ce, r: re}});\r\n\tlet imgEles = dom.getElementsByTagName('img');\r\n\tlet canvasEles = dom.getElementsByTagName('canvas');\r\n\tif (imgEles.length > 0) {\r\n\t\tlet imgEle = imgEles[0];\r\n\t\tlet width = 0, height = 0;\r\n\t\tif(get_computed_style) width = get_computed_style(imgEle).getPropertyValue('width').match(/\\d+/g)[0];\r\n\t\tif(get_computed_style) height = get_computed_style(imgEle).getPropertyValue('height').match(/\\d+/g)[0];\r\n\t\t// 创建 Canvas 元素\r\n\t\tconst canvas = document.createElement('canvas');\r\n\t\tcanvas.width = imgEle.width;\r\n\t\tcanvas.height = imgEle.height;\r\n\r\n\t\t// 将图像绘制到 Canvas 上\r\n\t\tconst ctx = canvas.getContext('2d');\r\n\t\tctx.drawImage(imgEle, 0, 0);\r\n\r\n\t\t// 获取 base64 编码的图像数据\r\n\t\tconst base64Image = canvas.toDataURL('image/png');\r\n\t\treturn {width: width, height: height, range: range, base64: base64Image};\r\n\t}\r\n\tif (canvasEles.length > 0) {\r\n\t\tlet canvasEle = canvasEles[0];\r\n\t\tlet width = 0, height = 0;\r\n\t\tif(get_computed_style) width = get_computed_style(canvasEle).getPropertyValue('width').match(/\\d+/g)[0];\r\n\t\tif(get_computed_style) height = get_computed_style(canvasEle).getPropertyValue('height').match(/\\d+/g)[0];\r\n\t\tconst base64Image = canvasEle.toDataURL('image/png');\r\n\t\treturn {width: width, height: height, range: range, base64: base64Image};\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nfunction setCellStyle(dom) {\r\n\tlet get_computed_style = get_get_computed_style_function(dom);\r\n\tlet o = {};\r\n\tif (get_computed_style) {\r\n\t\tlet font = {};\r\n\t\tfont.size = get_computed_style(dom).getPropertyValue('font-size').match(/\\d+/g)[0];\r\n\t\tlet fontName = get_computed_style(dom).getPropertyValue('font-family');\r\n\t\tfont.name = fontFamilyDict.indexOf([fontName]) !== -1 ? fontName : 'SimSun';\r\n\t\tfont.bold = get_computed_style(dom).getPropertyValue('font-weight') === '700';\r\n\t\tlet fontStyleDict = {italic: 'italic', oblique: 'oblique'};\r\n\t\tfont.italic = fontStyleDict[get_computed_style(dom).getPropertyValue('font-style')] ? true : false;\r\n\t\tlet textDecoration = get_computed_style(dom).getPropertyValue('text-decoration');\r\n\t\tfont.underline = textDecoration === 'underline' ? true : false;\r\n\t\tfont.strike = textDecoration === 'line-through' ? true : false;\r\n\r\n\t\tlet hex = RGBToHex(get_computed_style(dom).getPropertyValue('color')).color;\r\n\t\tfont.color = { argb: 'ff' + hex };\r\n\t\to.font = font;\r\n\t\tlet alignment = {};\r\n\t\talignment.wrapText = get_computed_style(dom).getPropertyValue('white-space') !== 'nowrap';\r\n\t\t//部分css和excel属性值未匹配\r\n\t\tlet horizontalDict = {left: 'left', center: 'center', right: 'right', justify: 'justify'};\r\n\t\talignment.horizontal = horizontalDict[get_computed_style(dom).getPropertyValue('text-align')] || 'center';\r\n\t\tlet verticalDict = {top: 'top', middle: 'middle', bottom: 'bottom'};\r\n\t\talignment.vertical = verticalDict[get_computed_style(dom).getPropertyValue('vertical-align')] || 'middle';\r\n\t\to.alignment = alignment;\r\n\t\tlet border = {\r\n\t\t\ttop: parseBorder(get_computed_style(dom).getPropertyValue('border-top')),\r\n\t\t\tbottom: parseBorder(get_computed_style(dom).getPropertyValue('border-bottom')),\r\n\t\t\tleft: parseBorder(get_computed_style(dom).getPropertyValue('border-left')),\r\n\t\t\tright: parseBorder(get_computed_style(dom).getPropertyValue('border-right')),\r\n\t\t};\r\n\t\to.border = JSON.parse(JSON.stringify(border));\r\n\t}\r\n\treturn o;\r\n}\r\n\r\nfunction svg2base64(svgElement) {\r\n\tconst serializer = new XMLSerializer();\r\n\tconst svgXML = serializer.serializeToString(svgElement);\r\n\treturn btoa(svgXML);\r\n}\r\n\r\nfunction parse_dom_table(table, _opts) {\r\n\tvar opts = _opts || {};\r\n\tvar ws = ({}); if(opts.dense) ws[\"!data\"] = [];\r\n\treturn sheet_add_dom(ws, table, _opts);\r\n}\r\n\r\nfunction decode_range(range) {\r\n\tvar idx = range.indexOf(\":\");\r\n\tif(idx == -1) return { s: decode_cell(range), e: decode_cell(range) };\r\n\treturn { s: decode_cell(range.slice(0, idx)), e: decode_cell(range.slice(idx + 1)) };\r\n}\r\n\r\nfunction encode_range(cs,ce) {\r\n\tif(typeof ce === 'undefined' || typeof ce === 'number') {\r\nreturn encode_range(cs.s, cs.e);\r\n\t}\r\nif(typeof cs !== 'string') cs = encode_cell((cs));\r\n\tif(typeof ce !== 'string') ce = encode_cell((ce));\r\nreturn cs == ce ? cs : cs + \":\" + ce;\r\n}\r\n\r\nfunction parseBorder(s) {\r\n\tlet str = s.replace(new RegExp(', ', 'g'), ',')\r\n\tlet arr = str.split(' ');\r\n\tlet dict = {solid: 'thin', dotted: 'dotted', dashed: 'dashDot', double: 'double'};\r\n\tlet style = dict[arr[1]];\r\n\tif (!style) return undefined;\r\n\tlet color = RGBToHex(arr[2]);\r\n\treturn {style, color: {argb: 'ff' + color.color}};\r\n}\r\n\r\nfunction RGBToHex(rgba) {\r\n\tif (rgba.startsWith('rgba')) {\r\n\t\tlet str = rgba.slice(5, rgba.length - 1),\r\n\t\t\tarry = str.split(','),\r\n\t\t\topa = Number(arry[3].trim()) * 100,\r\n\t\t\tstrHex = \"\",\r\n\t\t\tr = Number(arry[0].trim()),\r\n\t\t\tg = Number(arry[1].trim()),\r\n\t\t\tb = Number(arry[2].trim());\r\n\r\n\t\tstrHex += ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\r\n\r\n\t\treturn { color: strHex, opacity: opa };\r\n\t}\r\n\tlet str = rgba.slice(4, rgba.length - 1),\r\n\t\t\tarry = str.split(','),\r\n\t\t\tstrHex = \"\",\r\n\t\t\tr = Number(arry[0].trim()),\r\n\t\t\tg = Number(arry[1].trim()),\r\n\t\t\tb = Number(arry[2].trim());\r\n\r\n\tstrHex += ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\r\n\r\n\treturn { color: strHex };\r\n}\r\n\r\nfunction decode_cell(cstr) {\r\n\tvar R = 0, C = 0;\r\n\tfor(var i = 0; i < cstr.length; ++i) {\r\n\t\tvar cc = cstr.charCodeAt(i);\r\n\t\tif(cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);\r\n\t\telse if(cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\r\n\t}\r\n\treturn { c: C - 1, r:R - 1 };\r\n}\r\n\r\nfunction encode_cell(cell) {\r\n\tvar col = cell.c + 1;\r\n\tvar s=\"\";\r\n\tfor(; col; col=((col-1)/26)|0) s = String.fromCharCode(((col-1)%26) + 65) + s;\r\n\treturn s + (cell.r + 1);\r\n}\r\n\r\nfunction is_dom_element_hidden(element) {\r\n\tvar display = '';\r\n\tvar get_computed_style = get_get_computed_style_function(element);\r\n\tif(get_computed_style) display = get_computed_style(element).getPropertyValue('display');\r\n\tif(!display) display = element.style && element.style.display;\r\n\treturn display === 'none';\r\n}\r\n\r\nfunction datenum(v, date1904) {\r\n\tvar epoch = v.getTime();\r\n\tvar res = (epoch - dnthresh) / (24 * 60 * 60 * 1000);\r\n\tif(date1904) { res -= 1462; return res < -1402 ? res - 1 : res; }\r\n\treturn res < 60 ? res - 1 : res;\r\n}\r\n\r\nfunction get_get_computed_style_function(element) {\r\n\t// The proper getComputedStyle implementation is the one defined in the element window\r\n\tif(element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle;\r\n\t// If it is not available, try to get one from the global namespace\r\n\tif(typeof getComputedStyle === 'function') return getComputedStyle;\r\n\treturn null;\r\n}\r\n\r\nfunction local_to_utc(local) {\r\n\tconsole.log(new Date(Date.UTC(local.getFullYear(), local.getMonth(), local.getDate(), local.getHours(), local.getMinutes(), local.getSeconds(), local.getMilliseconds())))\r\n\treturn new Date(Date.UTC(local.getFullYear(), local.getMonth(), local.getDate(), local.getHours(), local.getMinutes(), local.getSeconds(), local.getMilliseconds()));\r\n}\r\n\r\nfunction parseDate(str, date1904) {\r\n\tif(str instanceof Date) return str;\r\n\tvar m = str.match(pdre1);\r\n\tif(m) return new Date((date1904 ? dnthresh2 : dnthresh1) + ((parseInt(m[1], 10)*60 + parseInt(m[2], 10))*60 + (m[3] ? parseInt(m[3].slice(1), 10) : 0))*1000 + (m[4] ? parseInt((m[4]+\"000\").slice(1,4), 10) : 0));\r\n\tm = str.match(pdre2);\r\n\tif(m) return new Date(Date.UTC(+m[1], +m[2]-1, +m[3], 0, 0, 0, 0));\r\n\t/* TODO: 1900-02-29T00:00:00.000 should return a flag to treat as a date code (affects xlml) */\r\n\tm = str.match(pdre3);\r\n\tif(m) return new Date(Date.UTC(+m[1], +m[2]-1, +m[3], +m[4], +m[5], ((m[6] && parseInt(m[6].slice(1), 10))|| 0), ((m[7] && parseInt(m[7].slice(1), 10))||0)));\r\n\tvar d = new Date(str);\r\n\treturn d;\r\n}\r\n\r\nfunction fuzzynum(s) {\r\n\tvar v = Number(s);\r\n\tif(!isNaN(v)) return isFinite(v) ? v : NaN;\r\n\tif(!/\\d/.test(s)) return v;\r\n\tvar wt = 1;\r\n\tvar ss = s.replace(/([\\d]),([\\d])/g,\"$1$2\").replace(/[$]/g,\"\").replace(/[%]/g, function() { wt *= 100; return \"\";});\r\n\tif(!isNaN(v = Number(ss))) return v / wt;\r\n\tss = ss.replace(/[(](.*)[)]/,function($$, $1) { wt = -wt; return $1;});\r\n\tif(!isNaN(v = Number(ss))) return v / wt;\r\n\treturn v;\r\n}\r\n\r\nfunction fuzzytime1(M)  {\r\n\tif(!M[2]) return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), 0, 0, 0));\r\n\tif(M[3]) {\r\n\t\t\tif(M[4]) return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], +M[4], parseFloat(M[3])*1000));\r\n\t\t\telse return new Date(Date.UTC(1899,11,31,(M[7] == \"p\" ? 12 : 0), +M[1], +M[2], parseFloat(M[3])*1000));\r\n\t}\r\n\telse if(M[5]) return new Date(Date.UTC(1899,11,31, (+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], +M[5], M[6] ? parseFloat(M[6]) * 1000 : 0));\r\n\telse return new Date(Date.UTC(1899,11,31,(+M[1]%12) + (M[7] == \"p\" ? 12 : 0), +M[2], 0, 0));\r\n}\r\nfunction fuzzytime2(M)  {\r\n\tif(!M[2]) return new Date(Date.UTC(1899,11,31,+M[1], 0, 0, 0));\r\n\tif(M[3]) {\r\n\t\t\tif(M[4]) return new Date(Date.UTC(1899,11,31,+M[1], +M[2], +M[4], parseFloat(M[3])*1000));\r\n\t\t\telse return new Date(Date.UTC(1899,11,31,0, +M[1], +M[2], parseFloat(M[3])*1000));\r\n\t}\r\n\telse if(M[5]) return new Date(Date.UTC(1899,11,31, +M[1], +M[2], +M[5], M[6] ? parseFloat(M[6]) * 1000 : 0));\r\n\telse return new Date(Date.UTC(1899,11,31,+M[1], +M[2], 0, 0));\r\n}\r\n\r\nfunction fuzzydate(s) {\r\n\t// See issue 2863 -- this is technically not supported in Excel but is otherwise useful\r\n\tif(FDISO.test(s)) return s.indexOf(\"Z\") == -1 ? local_to_utc(new Date(s)) : new Date(s);\r\n\tvar lower = s.toLowerCase();\r\n\tvar lnos = lower.replace(/\\s+/g, \" \").trim();\r\n\tvar M = lnos.match(FDRE1);\r\n\tif(M) return fuzzytime1(M);\r\n\tM = lnos.match(FDRE2);\r\n\tif(M) return fuzzytime2(M);\r\n\tM = lnos.match(pdre3);\r\n\tif(M) return new Date(Date.UTC(+M[1], +M[2]-1, +M[3], +M[4], +M[5], ((M[6] && parseInt(M[6].slice(1), 10))|| 0), ((M[7] && parseInt(M[7].slice(1), 10))||0)));\r\n\tvar o = new Date(utc_append_works && s.indexOf(\"UTC\") == -1 ? s + \" UTC\": s), n = new Date(NaN);\r\n\tvar y = o.getYear(), m = o.getMonth(), d = o.getDate();\r\n\tif(isNaN(d)) return n;\r\n\tif(lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\r\n\t\tlower = lower.replace(/[^a-z]/g,\"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,\"\");\r\n\t\tif(lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\r\n\t} else if(lower.replace(/[ap]m?/, \"\").match(/[a-z]/)) return n;\r\n\tif(y < 0 || y > 8099 || s.match(/[^-0-9:,\\/\\\\\\ ]/)) return n;\r\n\treturn o;\r\n}\r\n\r\nvar htmldecode = (function() {\r\n\tvar entities = [\r\n\t\t['nbsp', ' '], ['middot', '·'],\r\n\t\t['quot', '\"'], ['apos', \"'\"], ['gt',   '>'], ['lt',   '<'], ['amp',  '&']\r\n\t].map(function(x) { return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]]; });\r\n\treturn function htmldecode(str) {\r\n\t\tvar o = str\r\n\t\t\t\t// Remove new lines and spaces from start of content\r\n\t\t\t\t.replace(/^[\\t\\n\\r ]+/, \"\")\r\n\t\t\t\t// Remove new lines and spaces from end of content\r\n\t\t\t\t.replace(/[\\t\\n\\r ]+$/,\"\")\r\n\t\t\t\t// Added line which removes any white space characters after and before html tags\r\n\t\t\t\t.replace(/>\\s+/g,\">\").replace(/\\s+</g,\"<\")\r\n\t\t\t\t// Replace remaining new lines and spaces with space\r\n\t\t\t\t.replace(/[\\t\\n\\r ]+/g, \" \")\r\n\t\t\t\t// Replace <br> tags with new lines\r\n\t\t\t\t.replace(/<\\s*[bB][rR]\\s*\\/?>/g,\"\\n\")\r\n\t\t\t\t// Strip HTML elements\r\n\t\t\t\t.replace(/<[^>]*>/g,\"\");\r\n\t\tfor(var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\r\n\t\treturn o;\r\n\t};\r\n})();\r\n"],"names":["module","exports","__WEBPACK_EXTERNAL_MODULE_exceljs__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","ExcelJS","pdre1","pdre2","pdre3","dnthresh","Date","UTC","dnthresh1","dnthresh2","FDRE1","FDRE2","FDISO","utc_append_works","valueOf","lower_months","table_fmt","fontFamilyDict","defaultOptions","rows","font","alignment","border","numfmt","chart","generateExcel","tables","userOptions","ops","workbook","Workbook","table","xlsx","parse_dom_table","elet","worksheet","addWorksheet","name","columns","i","length","row","getRow","height","hpx","merges","merge","mergeCells","encode_range","data","cell","getCell","value","v","s","numFmt","z","imageId","addImage","base64","extension","tl","col","decode_cell","c","r","ext","width","writeBuffer","then","buffer","parseChart","dom","cs","rs","get_computed_style","get_get_computed_style_function","rowSpan","getAttribute","colSpan","re","Number","range","e","imgEles","getElementsByTagName","canvasEles","imgEle","getPropertyValue","match","canvas","document","createElement","getContext","drawImage","toDataURL","canvasEle","setCellStyle","size","fontName","indexOf","bold","fontStyleDict","italic","oblique","textDecoration","underline","strike","hex","RGBToHex","color","argb","wrapText","horizontalDict","left","center","right","justify","horizontal","verticalDict","top","middle","bottom","vertical","parseBorder","JSON","parse","stringify","_opts","ws","dense","tagName","opts","or_R","or_C","origin","_origin","sheetRows","Math","min","_range","idx","slice","decode_range","max","midx","rowinfo","_R","R","_C","C","RS","CS","colElems","colElem","push","String","toFixed","is_dom_element_hidden","display","hidden","clientHeight","trHeights","tr","elts","elt","hasAttribute","htmldecode","innerHTML","m","t","_t","raw","trim","isNaN","fuzzynum","fuzzydate","getDate","parseDate","local_to_utc","cellDates","datenum","dateNF","l","Aelts","Aelti","charAt","toLowerCase","Target","encode_cell","concat","console","log","sheet_add_dom","ce","arr","replace","RegExp","split","style","solid","dotted","dashed","double","rgba","startsWith","arry","opa","strHex","toString","opacity","cstr","cc","charCodeAt","fromCharCode","element","date1904","res","getTime","ownerDocument","defaultView","getComputedStyle","local","getFullYear","getMonth","getHours","getMinutes","getSeconds","getMilliseconds","str","parseInt","isFinite","NaN","test","wt","ss","$$","$1","lower","lnos","M","parseFloat","fuzzytime1","fuzzytime2","n","y","getYear","entities","map","x"],"sourceRoot":""}